from Products.Five.browser import BrowserView

from plone.app.vulnerabilities.content.vulnerability import AccessVectorVocabulary, ComplexityVocabulary, ImpactVocabulary, AuthenticationVocabulary

class VulnerabilityView(BrowserView): 

    def cvss_scores(self):

        score_css_classes = ["low", "medium", "high"]

        scores = []
        scores.append({"label": "Vector",
                       "css-class":  "",
                       "value": AccessVectorVocabulary.getTerm(self.context.cvss_access_vector).token})

        scores.append({"label": "Complexity",
                       "css-class":  "",
                       "value": ComplexityVocabulary.getTerm(self.context.cvss_access_complexity).token})

        scores.append({"label": "Authentication",
                       "css-class":  "",
                       "value": AuthenticationVocabulary.getTerm(self.context.cvss_authentication).token})

        scores.append({"label": "Confidentiality",
                       "css-class":  "",
                       "value": ImpactVocabulary.getTerm(self.context.cvss_confidentiality_impact).token})

        scores.append({"label": "Integrity",
                       "css-class":  "",
                       "value": ImpactVocabulary.getTerm(self.context.cvss_integrity_impact).token})

        scores.append({"label": "Availability",
                       "css-class":  "",
                       "value": ImpactVocabulary.getTerm(self.context.cvss_availability_impact).token})

        scores.append({"label": "Expliotability",
                       "css-class":  "",
                       "value": ImpactVocabulary.getTerm(self.context.cvss_exploitability).token})

        import pdb; pdb.set_trace( )
        return scores