from Products.Five.browser import BrowserView

from plone.app.vulnerabilities.content.vulnerability import AccessVectorVocabulary, ComplexityVocabulary, ImpactVocabulary, AuthenticationVocabulary

class VulnerabilityView(BrowserView): 

    def cvss_scores(self):

        scores = []
        term = AccessVectorVocabulary.getTerm(self.context.cvss_access_vector)
        scores.append({"label": "Vector",
                       "css-class":  term.token,
                       "value": term.title})

        term = ComplexityVocabulary.getTerm(self.context.cvss_access_complexity)
        scores.append({"label": "Complexity",
                       "css-class": term.token,
                       "value": term.title})

        term = AuthenticationVocabulary.getTerm(self.context.cvss_authentication)
        scores.append({"label": "Authentication",
                       "css-class":  term.token,
                       "value": term.title})

        term = ImpactVocabulary.getTerm(self.context.cvss_confidentiality_impact)
        scores.append({"label": "Confidentiality",
                       "css-class": term.token,
                       "value": term.title})
        
        term = ImpactVocabulary.getTerm(self.context.cvss_integrity_impact)
        scores.append({"label": "Integrity",
                       "css-class":  term.token,
                       "value": term.title})

        term = ImpactVocabulary.getTerm(self.context.cvss_availability_impact)
        scores.append({"label": "Availability",
                       "css-class": term.token,
                       "value": term.title})

        term = ImpactVocabulary.getTerm(self.context.cvss_exploitability)
        scores.append({"label": "Exploitability",
                       "css-class": term.token,
                       "value": term.title})

        return scores